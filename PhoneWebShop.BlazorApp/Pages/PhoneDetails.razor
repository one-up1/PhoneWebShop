@using PhoneWebShop.Domain.Entities;
@using System.Net.Http.Json

@page "/phone/{Id:int}"

@if (phone == null)
{
    <h3>Loading</h3>
}
else
{
    <div>
        <div class="phone">
            <h3>@phone.FullName</h3>
            <Button class="back-button" onclick="javascript:history.back()">Back</Button>

            <img src="phone.png" />
            <div class="phone-info">
                <h4>&euro;@phone.VATPrice</h4>

                @if (phone.Stock > 5)
                {
                    <p>phone.Stock in stock</p>
                }
                else
                {
                    <p>Almost out of stock! Only @phone.Stock left!</p>
                }
            </div>

            <div class="phone-description">
                @phone.Description
            </div>
        </div>
    </div>
}

@code {
    /*[Inject]
    IPhoneService PhoneService { get; set; }*/

    [Parameter]
    public int Id { get; set; }

    private Phone phone;

    protected override async void OnInitialized()
    {
        base.OnInitialized();

        HttpClient client = new HttpClient();
        phone = await client.GetFromJsonAsync<Phone>("https://localhost:44337/api/Phones/" + Id);
        StateHasChanged();

        //phone = await PhoneService.GetAsync(Id);
        StateHasChanged();
    }
}
